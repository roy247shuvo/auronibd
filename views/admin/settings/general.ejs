<div class="max-w-4xl mx-auto">
    <% if (!can('set_general', 'write')) { %>
    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 rounded-r shadow-sm">
        <div class="flex">
            <div class="flex-shrink-0">
                <span class="material-icons-outlined text-yellow-400">lock</span>
            </div>
            <div class="ml-3">
                <p class="text-sm text-yellow-700">
                    <span class="font-bold">View Only Mode:</span> You do not have permission to modify general settings.
                </p>
            </div>
        </div>
    </div>
    <% } %>

    <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-bold text-gray-900">General & Courier Settings</h1>
    </div>

    <form action="/admin/settings/general" method="POST" class="space-y-6">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">

        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
            <h2 class="text-lg font-bold text-gray-800 mb-4 pb-2 border-b border-gray-100">Site Configuration</h2>
            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Site URL (With https://)</label>
                <input type="url" name="site_url" value="<%= setting.site_url %>" required 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 outline-none focus:border-black disabled:bg-gray-100 disabled:text-gray-500"
                       placeholder="https://example.com" <%= can('set_general', 'write') ? '' : 'disabled' %>>
                <p class="text-[10px] text-gray-400 mt-1">Required for Webhooks to work.</p>
            </div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
            <div class="flex justify-between items-center mb-4 pb-2 border-b border-gray-100">
                <h2 class="text-lg font-bold text-gray-800">Steadfast Courier</h2>
                <% if(setting.steadfast_api_key) { %>
                    <span class="bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-bold">Balance: <%= balance %> TK</span>
                <% } %>
            </div>

            <div class="grid grid-cols-1 gap-4">
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">API Key</label>
                    <input type="text" name="steadfast_api_key" value="<%= setting.steadfast_api_key %>" 
                           class="w-full border border-gray-300 rounded-lg px-3 py-2 font-mono text-sm outline-none focus:border-green-500 disabled:bg-gray-100 disabled:text-gray-500"
                           <%= can('set_general', 'write') ? '' : 'disabled' %>>
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Secret Key</label>
                    <input type="text" name="steadfast_secret_key" value="<%= setting.steadfast_secret_key %>" 
                           class="w-full border border-gray-300 rounded-lg px-3 py-2 font-mono text-sm outline-none focus:border-green-500 disabled:bg-gray-100 disabled:text-gray-500"
                           <%= can('set_general', 'write') ? '' : 'disabled' %>>
                </div>
            </div>

            <% if(setting.steadfast_webhook_url) { %>
            <div class="mt-4 bg-gray-50 p-3 rounded border border-gray-200">
                <label class="block text-[10px] font-bold text-gray-400 uppercase mb-1">Your Webhook URL (Save this in Steadfast Portal)</label>
                <div class="flex items-center gap-2">
                    <code class="text-xs text-gray-600 font-mono"><%= setting.steadfast_webhook_url %></code>
                </div>
            </div>
            <% } %>
        </div>

        <% if (can('set_general', 'write')) { %>
        <button type="submit" class="bg-black text-white px-6 py-3 rounded-xl font-bold uppercase tracking-wider text-sm shadow hover:bg-gray-800 transition">
            Save Changes
        </button>
        <% } %>
    </form>
</div>